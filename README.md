Написать обработчик отчета, полученного из внешнего источника

В crm-системе присутствуют объекты вторичной недвижимости. Эти объекты рекламируются на внешних площадках (Циан, Авито и т.д.).
Для этого рекламная площадка периодически забирает из срм-системы файл-фид с описанием объектов (xml, json) и проверяет его на ошибки.
Прошедшие проверку выводятся на сайте рекламной площадки.
Раз в день компания запрашивает отчет о публикации объектов на рекламной площаке.

За каждый рекламируемый объект на рекламной площадке компания оплачивает некоторую сумму.
Сумма, которая затрачивается на один рекламируемый объект, зависит от тарифа. Тариф обладает следующими свойствами - временной интервал и стоимость тарифа.
Каждый день на рекламу всех объектов тратится одна и та же сумма (сумма / количество дней в тарифе), но то сколько тратится на один объект зависит от количества рекламируемых в данный день объектов (сумма / (количество дней в тарифе * количество опубликованных объектов)).
Это количество можно узнать из файла-отчета, у опубликованных объектов статус 'Published' (ссылка на доку Циан).

Дан файл-отчет от рекламной площадки в виде json-объекта. Каждый элемент отчета имеет следующую структуру:
 - offerId, int - уникальный идентификатор объекта на рекламной площадке
 - externalId, string - уникальный идентификатор объекта вторичной недвижимости в crm-системе
 - status, string - статус объекта на рекламной площадке

Дана SQLite БД со следующими таблицами
ResaleObject - объекты вторичной недвижимости, публикуемые на рекламной площадке
 - id, int - уникальный идентификатор, используется для связи объектов в crm-системе
 - guid, string - уникальный идентификатор, используется в отчете рекламной площадки
 - address, string - адрес объекта
 - status, string - статус объекта, возможные значения: active (выведен в рекламу), close (архив)
 - area, float - площадь

Tariff - тарифы, по которому считаются расходы на рекламу
 - id, int - уникальный идентификатор
 - start_date, date - дата начала действия тарифа
 - end_date, date - дата окончания действия тарифа
 - price, int - стоимость тарифа
 
Expense - расходы на рекламу, обработчик должен создавать и обновлять строки этой таблицы
 - id, int - уникальный идентификатор
 - resale_object, int - объекты вторичной недвижимости, внешний ключ на поле id таблицы ResaleObject
 - sum, int - сумма расходов на рекламу объекта


Требуется по предоставленному файлу-отчету по всем выведенным в рекламу объектам вторичной недвижимости посчитать расходы и сохранить их в таблицу Expense.

Написать запросы, выполняющие следующие выборки:
 - все опубликованные квартиры, площадью от 25 кв. м до 70 кв. м включительно, у которых расходы не менее 1000 руб.
 - все архивные объекты (статус close) с нулевым или отсутствующим расходом
 - количество объектов, расходы на которые превышают среднее значение расхода на объект

#### Если возникнут вопросы по заданию, пишите на 404@ndv.ru. Отвечаем в течение рабочего дня.
